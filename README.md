# Курсовой проект по курсу highload в технопарке

## 1. **Выбор темы**
Сервис по бронированию жилья(Booking.com,Airbnb)

## 2. **Определение возможного диапазона нагрузок подобного проекта**
### Самые крупные сервисы:
## Booking
- Месячная нагрузка- 288 миллионов просмотров сайта в месяц [Источник](https://www.similarweb.com/website/booking.com/#pro)
- Месячная аудитория - 14,5 миллионов пользователей [Источник](https://www.chinatravelnews.com/article/120426)

## Airbnb
- Месячная нагрузка (без учета региональных доменов)- 57 миллионов просмотров сайта в месяц [Источник](https://www.similarweb.c8 минут)om/website/airbnb.com/)
- Месячная аудитория- 13 миллионов просмотра сайта в месяц [Источник](https://www.chinatravelnews.com/article/120426)

Среднее время проведения на подобных сайтах- 8 минут [Источник](https://www.similarweb.com/website/booking.com/#pro)
## 3. **Выбор планируемой нагрузки**
Планируемая нагрузка - 50% от доли Airbnb и Booking, т.е
- Месячная аудитория:  
    ```(14,5+13)/2=13,75 миллиона человек в месяц=1,15 миллиона человек в день```
    
- Месячная нагрузка:  
`` (288+57)/2=172 миллиона просмотра сайта в месяц=14,4 миллиона просмотров в день``

Оценивая себя как среднестатистического пользователя, подсчитал сколько пользовательского трафика займет пример workflow для booking.com: 
Просмотр одной страницы ленты отелей, а так же переход на страницу отеля, заняло у меня это 1 минуту и 40 секунд. 
При этом на загрузку всего этого контента у меня израсходовалось 8 Мб (лента отелей) ![пруф (исправить ссылку)](https://www.similarweb.com/website/booking.com/#pro)+ 9.4 Мб страница отеля ![пруф (исправить ссылку)](https://www.similarweb.com/website/booking.com/#pro) = 17.4 Мб. Выходит приблизительно 0.158 Мб/с на одного среднестатистического пользователя

### За секунду:
- 1,15 млн * 0.158 Мб/с * ( (8/60)/ 24 ч) - плотность распределения) = 1009 Мб/с = 1.9 Гб/с  учитывая всех пользователей
- 1.9 Гб/с * 8 = 15.8 Гбит/с
### В день
- 1.9 Гб/c * 60 * 60 * 24 = 164160 Гб/день

## 4. **Логическая схема базы данных**
![alt-текст](https://github.com/EvilBorsch/booking-highload/blob/main/Снимок%20экрана%202020-10-21%20в%2016.38.54.png "Схема бд")


## 5. **Физическая системы хранения**

За 1 минуту и 40 секунд нахождения на сайте, было совершено (XHR + JS + CSS + IMG) 297+257 реквестов=554 реквеста. Так как в среднем пользователь проводит на сайте 8 минут в день будет выполнено 554*8/((60+40)/60)= 2659 запросов=2659/(8*60)=5.5 запросов в секунду.
Для всей аудитории  
```1,5 млн ежедневных пользователей * 5,5 RPS * (8/60)/24 (8 минут в день)=45833 RPS```

Для такой нагрузки возьмем 16 серверов с PostgreSQL. В среднем по 3000 RPS на 1. Все картинки будем хранить в Amazon S3 хранилище.

## 6. **Выбор прочих технологий**

##### Языки программирования

Backend - Golang. Язык предоставляет эффективный параллелизм, такой как C, C ++, Java, в то же время параллелизм в Go осуществляется намного проще благодаря горутинам, каналам и сборке мусора. Он имеет об обширную стандартную библиотеку, а также утилиты для форматирования кода, тестирования и расчета покрытия прямо из коробки. В нем очень удобно построена интеграция с внешними зависимостями посредствам go.mod. Go быстрый, кроссплатформенный, open-source с относительно низким порогом вхождения.

Frontend - HTML, CSS, TypeScript. Для  TypeScript будем использовать фреймворк React, который обеспечивает модульность, быстрый рендеринг, высокую run-time производительность. В сочетании с ES7 ReactTS может легко работать при высоких нагрузках. Также он имеет virtual DOM, которая позволяет упорядочивать документы форматов HTML, XHTML или XML в дерево, которое лучше всего подходит браузерам для анализа различных элементов веб-приложения.
	
##### Протоколы взаимодействия

Протокол связи между фронтендом и бэкендом - https, данные будут передаваться в формате json. 

Общение между микросервисами на бэкенде будет осуществляться по протоколу gRPC, данные будут передаваться в формате protobuf.

## 7. **Расчет нагрузки и потребного оборудования**

## 8. **Выбор хостинга / облачного провайдера и расположения серверов**

## 9. **Схема балансировки нагрузки (входящего трафика и внутрипроектного, терминация SSL)**

## 10. **Обеспечение отказоустойчивости** 
